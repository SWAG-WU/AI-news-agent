{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://ai-news-agent.example/schemas/source.schema.json",
  "title": "AI News Source Configuration",
  "description": "ç»Ÿä¸€çš„ä¿¡æ¯æºé…ç½®æ ¼å¼ï¼Œæ”¯æŒRSSã€APIã€çˆ¬è™«ç­‰å¤šç§é‡‡é›†æ–¹å¼",

  "definitions": {
    "Metadata": {
      "type": "object",
      "description": "ä¿¡æ¯æºå…ƒæ•°æ®",
      "properties": {
        "id": {
          "type": "string",
          "description": "å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä½¿ç”¨ snake_case",
          "pattern": "^[a-z][a-z0-9_]*$",
          "examples": ["openai_blog", "arxiv_cs_ai", "hacker_news"]
        },
        "name": {
          "type": "string",
          "description": "ä¿¡æ¯æºæ˜¾ç¤ºåç§°",
          "examples": ["OpenAI Blog", "arXiv CS.AI", "Hacker News"]
        },
        "description": {
          "type": "string",
          "description": "ä¿¡æ¯æºæè¿°",
          "examples": ["OpenAIå®˜æ–¹åšå®¢ï¼Œå‘å¸ƒGPTã€Agentç­‰æœ€æ–°ç ”ç©¶"]
        },
        "version": {
          "type": "string",
          "description": "é…ç½®ç‰ˆæœ¬",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "default": "1.0.0"
        },
        "tags": {
          "type": "array",
          "items": {"type": "string"},
          "description": "æ ‡ç­¾",
          "examples": [["official", "high-priority"], ["community", "discussion"]]
        },
        "homepage": {
          "type": "string",
          "format": "uri",
          "description": "ä¿¡æ¯æºå®˜ç½‘"
        },
        "icon": {
          "type": "string",
          "description": "å›¾æ ‡emojiæˆ–å›¾æ ‡URL",
          "examples": ["ğŸ¢", "https://example.com/icon.png"]
        }
      },
      "required": ["id", "name"]
    },

    "Categorization": {
      "type": "object",
      "description": "åˆ†ç±»ä¿¡æ¯",
      "properties": {
        "category": {
          "type": "string",
          "enum": ["academic", "lab_blog", "media", "tools", "community", "newsletter"],
          "description": "6å¤§åˆ†ç±»ä¹‹ä¸€"
        },
        "type": {
          "type": "string",
          "enum": ["rss", "api", "scraper", "newsletter", "social"],
          "description": "é‡‡é›†æ–¹å¼ç±»å‹"
        },
        "priority": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10,
          "default": 5,
          "description": "ä¼˜å…ˆçº§ï¼Œ1-10ï¼Œæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜"
        },
        "language": {
          "type": "string",
          "enum": ["zh", "en", "ja", "ko", "mixed"],
          "default": "en",
          "description": "å†…å®¹è¯­è¨€"
        }
      },
      "required": ["category", "type"]
    },

    "CollectorConfig": {
      "type": "object",
      "description": "é‡‡é›†å™¨é…ç½®",
      "oneOf": [
        {"$ref": "#/definitions/RSSCollector"},
        {"$ref": "#/definitions/APICollector"},
        {"$ref": "#/definitions/ScraperCollector"},
        {"$ref": "#/definitions/NewsletterCollector"}
      ]
    },

    "RSSCollector": {
      "type": "object",
      "properties": {
        "type": {"const": "rss"},
        "rss_url": {
          "type": "string",
          "format": "uri",
          "description": "RSS feed URL"
        },
        "base_url": {
          "type": "string",
          "format": "uri",
          "description": "ç”¨äºè§£æç›¸å¯¹è·¯å¾„çš„åŸºç¡€URL"
        },
        "update_frequency": {
          "type": "string",
          "enum": ["realtime", "hourly", "daily", "weekly"],
          "default": "daily",
          "description": "æ›´æ–°é¢‘ç‡"
        },
        "item_limit": {
          "type": "integer",
          "minimum": 1,
          "maximum": 1000,
          "default": 50,
          "description": "å•æ¬¡é‡‡é›†æœ€å¤§æ¡æ•°"
        }
      },
      "required": ["rss_url"]
    },

    "APICollector": {
      "type": "object",
      "properties": {
        "type": {"const": "api"},
        "base_url": {
          "type": "string",
          "format": "uri",
          "description": "APIåŸºç¡€URL"
        },
        "endpoint": {
          "type": "string",
          "description": "APIç«¯ç‚¹è·¯å¾„",
          "examples": ["/v0/newstories", "/api/query"]
        },
        "method": {
          "type": "string",
          "enum": ["GET", "POST"],
          "default": "GET"
        },
        "headers": {
          "type": "object",
          "description": "HTTPè¯·æ±‚å¤´"
        },
        "params": {
          "type": "object",
          "description": "æŸ¥è¯¢å‚æ•°",
          "additionalProperties": true
        },
        "body": {
          "type": "object",
          "description": "POSTè¯·æ±‚ä½“"
        },
        "response_format": {
          "type": "string",
          "enum": ["json", "xml", "html", "text"],
          "default": "json"
        },
        "data_path": {
          "type": "string",
          "description": "JSONæ•°æ®è·¯å¾„ï¼Œå¦‚ 'data.items'",
          "examples": ["data.items", "feed.entries", "results"]
        },
        "pagination": {
          "type": "object",
          "description": "åˆ†é¡µé…ç½®",
          "properties": {
            "type": {
              "type": "string",
              "enum": ["offset", "cursor", "page"]
            },
            "limit": {"type": "integer"},
            "max_pages": {"type": "integer"}
          }
        }
      },
      "required": ["base_url", "endpoint"]
    },

    "ScraperCollector": {
      "type": "object",
      "properties": {
        "type": {"const": "scraper"},
        "url": {
          "type": "string",
          "format": "uri",
          "description": "è¦æŠ“å–çš„URL"
        },
        "base_url": {
          "type": "string",
          "format": "uri",
          "description": "åŸºç¡€URL"
        },
        "selectors": {
          "type": "object",
          "description": "CSSé€‰æ‹©å™¨é…ç½®",
          "properties": {
            "container": {
              "type": "string",
              "description": "æ¡ç›®å®¹å™¨é€‰æ‹©å™¨",
              "examples": [".article", "div.post", "tr[data-post]"]
            },
            "title": {"type": "string", "examples": [".title", "h2", ".headline"]},
            "url": {"type": "string", "examples": ["a.link", ".permalink"]},
            "description": {"type": "string", "examples": [".summary", ".excerpt"]},
            "author": {"type": "string", "examples": [".author", ".byline"]},
            "published_at": {"type": "string", "examples": [".date", "time[datetime]"]},
            "score": {"type": "string", "examples": [".score", ".points"]}
          }
        },
        "list_pages": {
          "type": "array",
          "items": {"type": "string"},
          "description": "è¦æŠ“å–çš„åˆ—è¡¨é¡µURLåˆ—è¡¨"
        },
        "render_js": {
          "type": "boolean",
          "default": false,
          "description": "æ˜¯å¦éœ€è¦æ¸²æŸ“JavaScript"
        },
        "wait_for_selector": {
          "type": "string",
          "description": "ç­‰å¾…åŠ è½½çš„é€‰æ‹©å™¨"
        }
      },
      "required": ["url", "selectors"]
    },

    "NewsletterCollector": {
      "type": "object",
      "properties": {
        "type": {"const": "newsletter"},
        "url": {
          "type": "string",
          "format": "uri",
          "description": "Newsletterç½‘é¡µç‰ˆURL"
        },
        "archive_url": {
          "type": "string",
          "format": "uri",
          "description": "å­˜æ¡£é¡µé¢URL"
        },
        "extractor": {
          "type": "string",
          "enum": ["rss", "html", "custom"],
          "description": "æå–æ–¹å¼"
        },
        "rss_url": {
          "type": "string",
          "format": "uri",
          "description": "å¦‚æœæœ‰RSS"
        }
      },
      "required": ["url"]
    },

    "Authentication": {
      "type": "object",
      "description": "è®¤è¯é…ç½®",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["none", "api_key", "bearer", "oauth2", "basic"],
          "default": "none"
        },
        "api_key": {
          "type": "string",
          "description": "APIå¯†é’¥ï¼ˆæ”¯æŒç¯å¢ƒå˜é‡å¼•ç”¨ï¼Œå¦‚ ${ENV_NAME}ï¼‰"
        },
        "api_key_header": {
          "type": "string",
          "default": "X-API-Key",
          "description": "APIå¯†é’¥è¯·æ±‚å¤´åç§°"
        },
        "bearer_token": {
          "type": "string",
          "description": "Bearer tokenï¼ˆæ”¯æŒç¯å¢ƒå˜é‡ï¼‰"
        },
        "username": {"type": "string"},
        "password": {"type": "string"},
        "oauth2": {
          "type": "object",
          "properties": {
            "client_id": {"type": "string"},
            "client_secret": {"type": "string"},
            "token_url": {"type": "string", "format": "uri"},
            "scopes": {"type": "array", "items": {"type": "string"}}
          }
        }
      }
    },

    "RateLimit": {
      "type": "object",
      "description": "é™æµé…ç½®",
      "properties": {
        "requests_per_minute": {
          "type": "integer",
          "minimum": 1,
          "default": 10,
          "description": "æ¯åˆ†é’Ÿæœ€å¤§è¯·æ±‚æ•°"
        },
        "requests_per_hour": {
          "type": "integer",
          "minimum": 1,
          "description": "æ¯å°æ—¶æœ€å¤§è¯·æ±‚æ•°"
        },
        "burst_size": {
          "type": "integer",
          "minimum": 1,
          "default": 5,
          "description": "çªå‘è¯·æ±‚å¤§å°"
        },
        "retry_after": {
          "type": "integer",
          "minimum": 1,
          "default": 60,
          "description": "é™æµåé‡è¯•ç­‰å¾…æ—¶é—´ï¼ˆç§’ï¼‰"
        }
      }
    },

    "FilterRules": {
      "type": "object",
      "description": "è¿‡æ»¤è§„åˆ™",
      "properties": {
        "include_keywords": {
          "type": "array",
          "items": {"type": "string"},
          "description": "åŒ…å«å…³é”®è¯ï¼ˆä»»ä¸€åŒ¹é…å³é€šè¿‡ï¼‰"
        },
        "exclude_keywords": {
          "type": "array",
          "items": {"type": "string"},
          "description": "æ’é™¤å…³é”®è¯ï¼ˆä»»ä¸€åŒ¹é…å³è¿‡æ»¤ï¼‰"
        },
        "min_score": {
          "type": "number",
          "description": "æœ€ä½è¯„åˆ†"
        },
        "time_range": {
          "type": "object",
          "properties": {
            "max_age_hours": {"type": "integer"},
            "min_date": {"type": "string", "format": "date"}
          }
        },
        "domains": {
          "type": "array",
          "items": {"type": "string"},
          "description": "å…è®¸çš„åŸŸååˆ—è¡¨"
        }
      }
    },

    "ExtractionRules": {
      "type": "object",
      "description": "æå–è§„åˆ™",
      "properties": {
        "title_selector": {"type": "string"},
        "content_selector": {"type": "string"},
        "author_selector": {"type": "string"},
        "date_selector": {"type": "string"},
        "date_format": {
          "type": "string",
          "description": "æ—¥æœŸè§£ææ ¼å¼"
        },
        "cleanup_html": {
          "type": "boolean",
          "default": true,
          "description": "æ˜¯å¦æ¸…ç†HTML"
        },
        "truncate_length": {
          "type": "integer",
          "description": "å†…å®¹æˆªæ–­é•¿åº¦"
        }
      }
    },

    "CacheConfig": {
      "type": "object",
      "description": "ç¼“å­˜é…ç½®",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true
        },
        "ttl_minutes": {
          "type": "integer",
          "default": 60,
          "description": "ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰"
        },
        "strategy": {
          "type": "string",
          "enum": ["memory", "redis", "file"],
          "default": "memory"
        }
      }
    },

    "Status": {
      "type": "object",
      "description": "çŠ¶æ€ç®¡ç†",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true,
          "description": "æ˜¯å¦å¯ç”¨æ­¤ä¿¡æ¯æº"
        },
        "stable": {
          "type": "boolean",
          "default": false,
          "description": "æ˜¯å¦ä¸ºç¨³å®šä¿¡æ¯æºï¼ˆç»è¿‡æµ‹è¯•éªŒè¯ï¼‰"
        },
        "last_tested": {
          "type": "string",
          "format": "date-time",
          "description": "æœ€åæµ‹è¯•æ—¶é—´"
        },
        "health_check_url": {
          "type": "string",
          "format": "uri",
          "description": "å¥åº·æ£€æŸ¥URL"
        },
        "notes": {
          "type": "string",
          "description": "å¤‡æ³¨è¯´æ˜"
        }
      }
    },

    "Monitoring": {
      "type": "object",
      "description": "ç›‘æ§é…ç½®",
      "properties": {
        "log_level": {
          "type": "string",
          "enum": ["DEBUG", "INFO", "WARNING", "ERROR"],
          "default": "INFO"
        },
        "alert_on_failure": {
          "type": "boolean",
          "default": false
        },
        "metrics": {
          "type": "object",
          "properties": {
            "collect_count": {"type": "boolean", "default": true},
            "collect_duration": {"type": "boolean", "default": true},
            "error_rate": {"type": "boolean", "default": true}
          }
        }
      }
    }
  },

  "type": "object",
  "properties": {
    "metadata": {"$ref": "#/definitions/Metadata"},
    "categorization": {"$ref": "#/definitions/Categorization"},
    "collector": {"$ref": "#/definitions/CollectorConfig"},
    "authentication": {"$ref": "#/definitions/Authentication"},
    "rate_limit": {"$ref": "#/definitions/RateLimit"},
    "filters": {"$ref": "#/definitions/FilterRules"},
    "extraction": {"$ref": "#/definitions/ExtractionRules"},
    "cache": {"$ref": "#/definitions/CacheConfig"},
    "status": {"$ref": "#/definitions/Status"},
    "monitoring": {"$ref": "#/definitions/Monitoring"}
  },
  "required": ["metadata", "categorization", "collector"],

  "examples": [
    {
      "metadata": {
        "id": "openai_blog",
        "name": "OpenAI Blog",
        "description": "OpenAIå®˜æ–¹åšå®¢",
        "homepage": "https://openai.com/blog",
        "icon": "ğŸ¢",
        "tags": ["official", "high-priority"]
      },
      "categorization": {
        "category": "lab_blog",
        "type": "rss",
        "priority": 1,
        "language": "en"
      },
      "collector": {
        "type": "rss",
        "rss_url": "https://openai.com/blog/rss.xml",
        "base_url": "https://openai.com",
        "update_frequency": "daily",
        "item_limit": 20
      },
      "status": {
        "enabled": true,
        "stable": true
      }
    }
  ]
}
